# Enhanced Redback SmartBike IoT Kafka Environment Configuration

# ======================
# KAFKA CONFIGURATION
# ======================

# Kafka Brokers (comma-separated list for cluster setup)
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
# KAFKA_BOOTSTRAP_SERVERS=broker1:9092,broker2:9092,broker3:9092

# Kafka Client Configuration
KAFKA_CLIENT_ID=redback-smartbike-iot-v2
KAFKA_CONSUMER_GROUP_ID=sensor-data-group-v2

# Kafka Security (uncomment and configure for production)
# KAFKA_SSL_ENABLED=true
# KAFKA_SASL_ENABLED=true
# KAFKA_SASL_MECHANISM=SCRAM-SHA-256
# KAFKA_SASL_USERNAME=your-username
# KAFKA_SASL_PASSWORD=your-password

# Kafka Connection Settings
KAFKA_CONNECTION_TIMEOUT=5000
KAFKA_REQUEST_TIMEOUT=30000
KAFKA_SESSION_TIMEOUT=30000
KAFKA_HEARTBEAT_INTERVAL=3000
KAFKA_MAX_WAIT_TIME=5000

# Kafka Retry Configuration
KAFKA_RETRIES=8
KAFKA_INITIAL_RETRY_TIME=100
KAFKA_MAX_RETRY_TIME=30000
KAFKA_RETRY_FACTOR=2
KAFKA_RETRY_MULTIPLIER=2

# Kafka Consumer Configuration
KAFKA_ALLOW_AUTO_TOPIC_CREATION=false
KAFKA_CONCURRENT_PARTITIONS=4
KAFKA_CONSUMER_RETRIES=5

# Kafka Producer Configuration
KAFKA_MAX_IN_FLIGHT=1
KAFKA_IDEMPOTENT=true
KAFKA_TRANSACTION_TIMEOUT=30000
KAFKA_PRODUCER_RETRIES=5

# ======================
# TOPIC CONFIGURATION
# ======================

# Topic Patterns
SENSOR_TOPIC_PATTERN=bike.{deviceId}.{sensorType}
CONTROL_TOPIC_PATTERN=bike.{deviceId}.{sensorType}.control
DLQ_TOPIC_SUFFIX=.dlq.v2
METRICS_TOPIC_PREFIX=sensor.metrics

# Default Device IDs (comma-separated)
DEFAULT_DEVICE_IDS=000001,000002,000003

# ======================
# DATABASE CONFIGURATION
# ======================

# MongoDB Connection
MONGODB_URL=mongodb://localhost:27017/smart-bike
# MONGODB_URL=mongodb+srv://username:password@cluster.mongodb.net/smart-bike?retryWrites=true&w=majority

# MongoDB Connection Pool Settings
MONGO_MAX_POOL_SIZE=20
MONGO_SERVER_SELECTION_TIMEOUT=5000
MONGO_SOCKET_TIMEOUT=45000
MONGO_CONNECT_TIMEOUT=10000

# ======================
# PROCESSING CONFIGURATION
# ======================

# Data Validation
ENABLE_DATA_VALIDATION=true
MIN_QUALITY_SCORE=50
ENABLE_ANOMALY_DETECTION=true

# Retry Configuration
MAX_SAVE_RETRIES=3
SAVE_RETRY_DELAY_MS=1000

# Performance Monitoring
ENABLE_METRICS=true
SLOW_PROCESSING_THRESHOLD_MS=1000
METRICS_REPORTING_INTERVAL=100

# Message Processing
MAX_MESSAGE_AGE_MS=300000

# ======================
# WEBSOCKET CONFIGURATION
# ======================

# WebSocket Bridge Settings
WEBSOCKET_PORT=3001
FRONTEND_URL=http://localhost:3000
ENABLE_SSE=true

# Connection Management
WS_CONNECTION_TIMEOUT_MS=300000
WS_HEARTBEAT_INTERVAL_MS=30000
MAX_WS_CONNECTIONS=1000

# Enhanced Features
ENABLE_CONNECTION_TRACKING=true
ENABLE_SUBSCRIPTION_MANAGEMENT=true

# ======================
# API CONFIGURATION
# ======================

# API Server Settings
API_PORT=3000

# Basic Authentication
BASIC_AUTH_USERNAME=admin
BASIC_AUTH_PASSWORD=smartbike2024!

# JWT Configuration (for future use)
JWT_SECRET=your-super-secret-jwt-key-change-in-production
JWT_EXPIRATION=1h

# Rate Limiting
ENABLE_RATE_LIMIT=false
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# ======================
# SECURITY CONFIGURATION
# ======================

# CORS Settings
CORS_ORIGIN=http://localhost:3000
CORS_CREDENTIALS=true

# Security Headers
ENABLE_HELMET=true

# ======================
# LOGGING CONFIGURATION
# ======================

# Log Levels: error, warn, info, debug
LOG_LEVEL=info
ENABLE_CONSOLE_LOGGING=true
ENABLE_FILE_LOGGING=false
LOG_FILE_PATH=./logs/smartbike.log

# Structured Logging
ENABLE_STRUCTURED_LOGGING=false
LOG_FORMAT=combined

# ======================
# FEATURE FLAGS
# ======================

# Enhanced Processing Features
ENABLE_ENHANCED_VALIDATION=true
ENABLE_DLQ=true
ENABLE_METRICS_REPORTING=true
ENABLE_HEALTH_CHECKS=true
ENABLE_GRACEFUL_SHUTDOWN=true
ENABLE_BATCH_PROCESSING=false
ENABLE_COMPRESSION=false

# ======================
# DEVELOPMENT/TESTING
# ======================

# Environment
NODE_ENV=development
# NODE_ENV=production

# Development Features
ENABLE_DEBUG_LOGGING=false
ENABLE_MOCK_DATA=false
SKIP_DATABASE_OPS=false

# Testing
ENABLE_TEST_MODE=false
TEST_KAFKA_BROKERS=localhost:9093
TEST_MONGODB_URL=mongodb://localhost:27017/smart-bike-test

# ======================
# MONITORING & ALERTING
# ======================

# Health Check Configuration
HEALTH_CHECK_INTERVAL_MS=30000
HEALTH_CHECK_TIMEOUT_MS=5000

# Alerting Thresholds
ALERT_ERROR_RATE_THRESHOLD=0.05
ALERT_RESPONSE_TIME_THRESHOLD_MS=5000
ALERT_MEMORY_USAGE_THRESHOLD_MB=1024

# External Monitoring (optional)
# PROMETHEUS_ENABLED=false
# PROMETHEUS_PORT=9090
# GRAFANA_DASHBOARD_URL=http://localhost:3000

# ======================
# CLUSTERING & SCALING
# ======================

# Service Discovery
# CONSUL_ENABLED=false
# CONSUL_HOST=localhost
# CONSUL_PORT=8500

# Load Balancing
# LOAD_BALANCER_ENABLED=false
# INSTANCE_ID=smartbike-iot-1

# Auto Scaling
# AUTO_SCALING_ENABLED=false
# MIN_INSTANCES=2
# MAX_INSTANCES=10

# ======================
# BACKUP & RECOVERY
# ======================

# Data Backup
# BACKUP_ENABLED=false
# BACKUP_INTERVAL_HOURS=24
# BACKUP_RETENTION_DAYS=7
# BACKUP_STORAGE_PATH=./backups

# Disaster Recovery
# DR_ENABLED=false
# DR_REPLICA_SET=replica-set-name
# DR_FAILOVER_TIMEOUT_MS=30000

# ======================
# PERFORMANCE TUNING
# ======================

# JVM/Node.js Memory Settings
# NODE_OPTIONS=--max-old-space-size=2048

# Kafka Performance Tuning
KAFKA_FETCH_MAX_WAIT_MS=500
KAFKA_FETCH_MIN_BYTES=1
KAFKA_FETCH_MAX_BYTES=52428800

# Database Performance
MONGO_READ_PREFERENCE=primary
MONGO_WRITE_CONCERN=1

# ======================
# EXTERNAL INTEGRATIONS
# ======================

# Third-party APIs
# WEATHER_API_KEY=your-weather-api-key
# MAPS_API_KEY=your-maps-api-key
# ANALYTICS_API_KEY=your-analytics-api-key

# Email/SMS Notifications
# EMAIL_SERVICE=smtp
# EMAIL_HOST=smtp.gmail.com
# EMAIL_PORT=587
# EMAIL_USER=your-email@example.com
# EMAIL_PASS=your-email-password

# Slack Integration
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK

# ======================
# VERSION & DEPLOYMENT
# ======================

# Application Version
APP_VERSION=2.0.0
BUILD_NUMBER=001
DEPLOYMENT_ENVIRONMENT=development

# Git Information
# GIT_COMMIT_HASH=abcd1234
# GIT_BRANCH=main
# BUILD_TIMESTAMP=2024-01-01T00:00:00Z

# Container Information
# CONTAINER_ID=smartbike-iot-container
# KUBERNETES_NAMESPACE=smartbike
# POD_NAME=smartbike-iot-pod
